<%- include('includes/header') %>
    <section>
        <div class="max-w-3xl mx-auto bg-white p-6 rounded-lg shadow-md">
            <h1 class="text-2xl font-bold mb-4">Edit your Blog</h1>
            <% if (typeof message !=='undefined' && message) { %>
                <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4" role="alert">
                    <span class="block sm:inline">
                        <%= message %>
                    </span>
                </div>
                <% } %>
                    <form action="" method="post"  class="space-y-4" enctype="multipart/form-data" id="blog_form">
                        <div>
                            <img src="/uploads/<%=blog_details.coverImage%>" alt="">
                        </div>
                        <div>
                            <label for="title" class="block text-sm font-medium text-gray-700">Blog Title</label>
                            <input type="text" name="title" id="title" required value="<%=blog_details.title%>"
                                class="mt-1 p-2 border border-gray-300 rounded-md w-full">
                                <input type="id" name="id" id="id" hidden value="<%=blog_details.id%>">
                        </div>
                        <div>
                            <label for="body" class="block text-sm font-medium text-gray-700">Blog Body</label>
                            <textarea name="body" id="body" rows="10" required 
                                class="mt-1 p-2 border border-gray-300 rounded-md w-full"><%=blog_details.body%></textarea>
                        </div>
                        
                        <div>
                            <button 
                                class="w-full bg-blue-500 text-white p-2 rounded-md font-semibold hover:bg-blue-700">Update
                                Blog</button>
                        </div>
                    </form>
        </div>
    </section>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script>
        let form=document.getElementById('blog_form');
        console.log(form);
        form.addEventListener('submit',async (event)=>{
                event.preventDefault();
                alert("hii")
                let title = document.getElementById('title').value;
                let body = document.getElementById('body').value;
                let id = document.getElementById('id').value;
                let blog_details = {
                id: id,
                title: title,
                body: body
                };
                let response=await axios.post('/blog/update-blog', blog_details);
                if(response.data.message===true){
                    alert("Blog updated successfully")
                    document.getElementById('title').value=title;
                    document.getElementById('body').value= body;
                }
                else{
                    window.location.href='/user/login';
                }
        })
    </script>
    <script src="/socket.io/socket.io.js"></script>
    
    <script>
        const socket = io({
            auth:{
                token:'<%= cookies.user_id%>'
            }
        });
    </script>
    <%- include('includes/footer') %>